<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BizLink Client Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#0f0f14;color:#fff}
.header{display:flex;justify-content:space-between;align-items:center;
padding:14px 20px;background:#111}
.back-btn{color:#fff;text-decoration:none;background:#444;
padding:6px 12px;border-radius:6px;font-size:13px}
.container{max-width:1100px;margin:auto;padding:20px}
.card{background:#1a1a2a;border-radius:12px;padding:18px;margin-bottom:16px}
.badge{background:#ffb300;color:#000;padding:5px 12px;border-radius:20px;font-size:12px}
.task-item{background:#222;padding:12px;border-radius:8px;margin-bottom:10px}
.task-title{font-weight:600}
.task-status{font-size:12px;opacity:.8}
.proof-link{color:#8a7cff}
</style>
</head>

<body>

<div class="header">
  <a href="index.html" class="back-btn">â¬… Back</a>
  <b>BizLink Client Dashboard</b>
</div>

<div class="container">

<div class="card">
  <p><b>Business:</b> <span id="businessName">Loadingâ€¦</span></p>
  <p><b>Plan:</b> <span id="plan"></span></p>
  <p><b>Status:</b> <span class="badge" id="status"></span></p>
</div>

<div class="card">
  <h3>ðŸ“… Todayâ€™s Tasks</h3>
  <div id="taskList">Loadingâ€¦</div>
</div>

</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzJvUnmkM7wUuvNt0XaSHE7YEn1FnLqQ2XX-Fues2h4q53MuGtRkoU0iGJ1auI1lSqoRQ/exec";
const CLIENT_ID = new URLSearchParams(window.location.search).get("client_id") || "CL001";

fetch(`${WEB_APP_URL}?action=getClientDashboardById&client_id=${CLIENT_ID}`)
.then(r=>r.json())
.then(d=>{
  if(!d.ok){alert(d.error);return;}
  businessName.innerText=d.client.name;
  plan.innerText=d.client.plan;
  status.innerText=d.client.status;

  taskList.innerHTML="";
  if(!d.todayTasks.length){
    taskList.innerHTML="<p>No task today</p>";return;
  }
  d.todayTasks.forEach(t=>{
    taskList.innerHTML+=`
      <div class="task-item">
        <div class="task-title">${t.task}</div>
        <div class="task-status">${t.status}</div>
        ${t.proof?`<a href="${t.proof}" target="_blank" class="proof-link">View Proof</a>`:""}
      </div>`;
  });
})
.catch(e=>{
  console.error(e);
  alert("API connection failed");
});
</script>

</body>
</html>
