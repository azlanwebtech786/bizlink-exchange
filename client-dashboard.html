<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BizLink 10X Grow Lab – Client Work Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:Poppins;
  background:linear-gradient(180deg,#050816,#020617);
  color:#e5e7eb;
}
.container{max-width:1200px;margin:auto;padding:24px}
.card{
  background:linear-gradient(180deg,#0f172a,#020617);
  border:1px solid rgba(148,163,184,.15);
  border-radius:14px;
  padding:20px;
}
.grid{display:grid;gap:20px}
.grid-4{grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
.grid-2{grid-template-columns:2fr 1fr}
.small{font-size:13px;color:#94a3b8}
.big{font-size:26px;font-weight:700}
.badge{background:#7c3aed;padding:4px 10px;border-radius:999px;font-size:12px}
.progress-bar{
  background:#020617;
  border-radius:10px;
  overflow:hidden;
  height:10px;
}
.progress-fill{
  background:linear-gradient(90deg,#8b5cf6,#ec4899);
  height:100%;
}
ul{padding-left:18px}
</style>
</head>

<body>
<div class="container">

<!-- HEADER -->
<div class="card grid grid-2">
  <div>
    <div class="small">Client Work Dashboard</div>
    <h2 id="clientName">Loading…</h2>
    <div class="small">City: <span id="clientCity">—</span></div>
    <span class="badge" id="clientPlan">—</span>
  </div>
  <div>
    <div class="small">Overall Progress</div>
    <div class="big"><span id="overallPercent">0</span>% Complete</div>
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill" style="width:0%"></div>
    </div>
  </div>
</div>

<br>

<!-- WORK STATUS -->
<div class="card">
  <h3>Work Status Timeline</h3>
  <ul class="small" id="timeline"></ul>
</div>

<br>

<!-- CONTENT -->
<div class="card">
  <h3>Content Engine</h3>
  <div class="grid grid-4">
    <div>Posts: <b id="postsDone">0</b> / <span id="postsTotal">0</span></div>
    <div>Reels: <b id="reelsDone">0</b> / <span id="reelsTotal">0</span></div>
  </div>
</div>

<br>

<!-- ADS -->
<div class="card">
  <h3>Ads Performance</h3>
  <div class="grid grid-4">
    <div>Reach<br><b id="reach">0</b></div>
    <div>Spend<br><b>₹<span id="spend">0</span></b></div>
    <div>Leads<br><b id="adLeads">0</b></div>
    <div>Avg CPL<br><b>₹<span id="cpl">0</span></b></div>
  </div>
</div>

<br>

<!-- FUNNEL -->
<div class="card">
  <h3>Leads → Sales Funnel</h3>
  <div class="grid grid-4">
    <div>Leads<br><b id="fLeads">0</b></div>
    <div>Contacted<br><b id="fContacted">0</b></div>
    <div>Sales<br><b id="fSales">0</b></div>
    <div>Revenue<br><b>₹<span id="fRevenue">0</span></b></div>
  </div>
</div>

<br>

<!-- PENDING -->
<div class="card">
  <h3>Pending / Upcoming Tasks</h3>
  <ul class="small" id="pendingList"></ul>
</div>

</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyjzwD5T4KMgWG9OIJIRaS4Wh5DYJmryfcxLOAdL0KAEK7MokIHw0CPqUNYaN62yolaNA/exec";
const email = new URLSearchParams(window.location.search).get("email");

fetch(`${API_URL}?action=getClientDashboard&email=${email}`)
.then(res=>res.json())
.then(data=>{
  document.getElementById("clientName").innerText = data.client.name;
  document.getElementById("clientCity").innerText = data.client.city;
  document.getElementById("clientPlan").innerText = data.client.plan;

  document.getElementById("overallPercent").innerText = data.progress.overall;
  document.getElementById("progressFill").style.width = data.progress.overall+"%";

  const timeline = document.getElementById("timeline");
  timeline.innerHTML = `
    <li>Onboarding: ${data.progress.onboarding ? "✅" : "⏳"}</li>
    <li>Content: ${data.progress.content ? "✅" : "⏳"}</li>
    <li>Ads: ${data.progress.ads}</li>
    <li>Leads: ${data.progress.leads}</li>
    <li>Sales Tracking: ${data.progress.sales}</li>
  `;

  postsDone.innerText=data.content.postsDone;
  postsTotal.innerText=data.content.postsTotal;
  reelsDone.innerText=data.content.reelsDone;
  reelsTotal.innerText=data.content.reelsTotal;

  reach.innerText=data.ads.reach;
  spend.innerText=data.ads.spend;
  adLeads.innerText=data.ads.leads;
  cpl.innerText=data.ads.cpl;

  fLeads.innerText=data.funnel.leads;
  fContacted.innerText=data.funnel.contacted;
  fSales.innerText=data.funnel.sales;
  fRevenue.innerText=data.funnel.revenue;

  pendingList.innerHTML=data.pending.map(p=>`<li>${p}</li>`).join("");
});
</script>
</body>
</html>
