<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bizlink 10X â€“ Admin Control Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial;
  background:#0f172a;
  color:#fff;
}
.container{max-width:1200px;margin:auto;padding:20px}
.card{
  background:#1e293b;
  padding:20px;
  border-radius:10px;
  margin-bottom:20px;
}
button{
  padding:8px 14px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}
.active{background:#16a34a}
.inactive{background:#dc2626}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:10px;
  border-bottom:1px solid #334155;
  text-align:left;
}
</style>
</head>

<body>
<div class="container">

<h2>ðŸ›¡ Bizlink 10X â€“ Admin Dashboard</h2>

<div class="card">
  <button onclick="loadClients()">Load All Clients</button>
</div>

<div class="card">
  <h3>Clients</h3>
  <table id="clientTable">
    <thead>
      <tr>
        <th>ID</th><th>Name</th><th>Plan</th><th>Status</th><th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<div class="card">
  <button onclick="loadExperts()">Load Experts</button>
</div>

<div class="card">
  <h3>Experts</h3>
  <table id="expertTable">
    <thead>
      <tr>
        <th>ID</th><th>Name</th><th>Skills</th><th>Status</th><th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<div class="card">
  <h3>Assign Expert to Client</h3>
  <input id="expertId" placeholder="Expert ID">
  <input id="clientId" placeholder="Client ID">
  <button onclick="assign()">Assign</button>
</div>

</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyN0Y-GzDaDrje8fxRSm2WTUYpj1B7LbBAIEeVKlfvIagXanj5TA2P8QUbjL0Tx-kmNHw/exec";
const API_KEY = "BIZLINK_10X_SECRET_2026";

/* ================= CLIENTS ================= */

function loadClients(){
  fetch(API_URL, {
    method:"POST",
    body: JSON.stringify({
      apiKey: API_KEY,
      action:"getAllClients"
    })
  })
  .then(r=>r.json())
  .then(data=>{
    const tbody = document.querySelector("#clientTable tbody");
    tbody.innerHTML="";
    data.forEach(c=>{
      tbody.innerHTML+=`
        <tr>
          <td>${c.id}</td>
          <td>${c.name}</td>
          <td>${c.plan}</td>
          <td>${c.status}</td>
          <td>
            <button class="${c.status==='Active'?'inactive':'active'}"
              onclick="toggleClient('${c.id}','${c.status}')">
              ${c.status==='Active'?'Deactivate':'Activate'}
            </button>
          </td>
        </tr>`;
    });
  });
}

function toggleClient(id,status){
  const newStatus = status==='Active'?'Inactive':'Active';
  fetch(API_URL,{
    method:"POST",
    body: JSON.stringify({
      apiKey:API_KEY,
      action:"toggleClient",
      clientId:id,
      status:newStatus
    })
  }).then(()=>loadClients());
}

/* ================= EXPERTS ================= */

function loadExperts(){
  fetch(API_URL,{
    method:"POST",
    body: JSON.stringify({
      apiKey:API_KEY,
      action:"getExperts"
    })
  })
  .then(r=>r.json())
  .then(data=>{
    const tbody = document.querySelector("#expertTable tbody");
    tbody.innerHTML="";
    data.forEach(e=>{
      tbody.innerHTML+=`
        <tr>
          <td>${e.id}</td>
          <td>${e.name}</td>
          <td>${e.skills}</td>
          <td>${e.status}</td>
          <td>
            <button class="${e.status==='Active'?'inactive':'active'}"
              onclick="toggleExpert('${e.id}','${e.status}')">
              ${e.status==='Active'?'Deactivate':'Activate'}
            </button>
          </td>
        </tr>`;
    });
  });
}

function toggleExpert(id,status){
  const newStatus = status==='Active'?'Inactive':'Active';
  fetch(API_URL,{
    method:"POST",
    body: JSON.stringify({
      apiKey:API_KEY,
      action:"toggleExpert",
      expertId:id,
      status:newStatus
    })
  }).then(()=>loadExperts());
}

/* ================= PERMISSION ================= */

function assign(){
  const expertId = document.getElementById("expertId").value;
  const clientId = document.getElementById("clientId").value;

  fetch(API_URL,{
    method:"POST",
    body: JSON.stringify({
      apiKey:API_KEY,
      action:"assignPermission",
      expertId,
      clientId
    })
  }).then(()=>alert("Assigned Successfully"));
}
</script>

</body>
</html>
