<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bizlink 10X â€“ Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Poppins;background:#020617;color:#fff;margin:0;padding:24px}
.card{background:#0f172a;padding:20px;border-radius:12px;margin-bottom:20px}
button{padding:10px 16px;border:none;border-radius:8px;cursor:pointer;margin-top:10px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{padding:10px;border-bottom:1px solid #1f2937;text-align:left}
</style>
</head>
<body>

<h2>ðŸ›¡ Bizlink 10X â€“ Admin Control Panel</h2>

<div class="card">
  <button onclick="loadClients()">Load All Clients</button>
  <table id="clientsTable">
    <thead>
      <tr>
        <th>Client ID</th>
        <th>Name</th>
        <th>Plan</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<div class="card">
  <button onclick="loadExperts()">Load Experts</button>
  <table id="expertsTable">
    <thead>
      <tr>
        <th>Expert ID</th>
        <th>Name</th>
        <th>Skills</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<div class="card">
  <h3>Assign Expert to Client</h3>
  <input id="exId" placeholder="Expert ID">
  <input id="clId" placeholder="Client ID">
  <button onclick="assignPerm()">Assign Permission</button>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzJhKn05BcXVU1joI_R8r5N_TXZ8bcCC0mNmw5lWX2RX2Lzfg00jr18i8IbQq1WOSga/exec";
const API_KEY = "BIZLINK_10X_SECRET_2026";

function loadClients(){
  fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      apiKey:API_KEY,
      action:"getAllClients"
    })
  })
  .then(r=>r.json())
  .then(data=>{
    const tbody=document.querySelector("#clientsTable tbody");
    tbody.innerHTML="";
    data.forEach(c=>{
      tbody.innerHTML+=`
        <tr>
          <td>${c.id}</td>
          <td>${c.name}</td>
          <td>${c.plan}</td>
          <td>${c.status}</td>
          <td>
            <button onclick="toggleClient('${c.id}','Active')">Activate</button>
            <button onclick="toggleClient('${c.id}','DeActive')">DeActive</button>
          </td>
        </tr>`;
    });
  });
}

function toggleClient(id,status){
  fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      apiKey:API_KEY,
      action:"toggleClient",
      clientId:id,
      status:status
    })
  }).then(()=>loadClients());
}

function loadExperts(){
  fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      apiKey:API_KEY,
      action:"getExperts"
    })
  })
  .then(r=>r.json())
  .then(data=>{
    const tbody=document.querySelector("#expertsTable tbody");
    tbody.innerHTML="";
    data.forEach(e=>{
      tbody.innerHTML+=`
        <tr>
          <td>${e.id}</td>
          <td>${e.name}</td>
          <td>${e.skills}</td>
          <td>${e.status}</td>
          <td>
            <button onclick="toggleExpert('${e.id}','Active')">Activate</button>
            <button onclick="toggleExpert('${e.id}','DeActive')">DeActive</button>
          </td>
        </tr>`;
    });
  });
}

function toggleExpert(id,status){
  fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      apiKey:API_KEY,
      action:"toggleExpert",
      expertId:id,
      status:status
    })
  }).then(()=>loadExperts());
}

function assignPerm(){
  const ex=document.getElementById("exId").value;
  const cl=document.getElementById("clId").value;

  fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      apiKey:API_KEY,
      action:"assignPermission",
      expertId:ex,
      clientId:cl
    })
  }).then(()=>alert("Permission Assigned"));
}
</script>

</body>
</html>
