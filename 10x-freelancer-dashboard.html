<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BizLink – Freelancer Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{font-family:Poppins;background:#020617;color:#e5e7eb}
.card{background:#0b1220;border:1px solid rgba(148,163,184,.25)}
</style>
</head>

<body class="min-h-screen">

<header class="bg-slate-950 border-b border-slate-800">
  <div class="max-w-6xl mx-auto px-4 py-3 flex justify-between">
    <h1 class="font-bold text-purple-400">BizLink Freelancer</h1>
    <div>
      <span id="email" class="text-sm text-slate-400"></span>
      <button onclick="logout()" class="ml-3 bg-red-600 px-3 py-1 rounded text-sm">Logout</button>
    </div>
  </div>
</header>

<main class="max-w-6xl mx-auto px-4 py-8">

<h2 class="text-lg font-semibold mb-4">Today’s Assigned Tasks</h2>

<div class="card rounded overflow-hidden">
<table class="w-full text-sm">
<thead class="bg-slate-800">
<tr>
<th class="p-3 text-left">Client</th>
<th class="p-3">Task</th>
<th class="p-3">Status</th>
<th class="p-3">Action</th>
</tr>
</thead>
<tbody id="tasks">
<tr>
<td colspan="4" class="p-6 text-center text-slate-400">Loading...</td>
</tr>
</tbody>
</table>
</div>

</main>

<script>
const API = "YOUR_WEB_APP_URL";
const email = localStorage.getItem("email");

if(!email) location.href="login.html";
document.getElementById("email").innerText = email;

async function loadTasks(){
  const res = await fetch(`${API}?action=getFieldExecTasks&email=${email}`);
  const data = await res.json();

  const tb = document.getElementById("tasks");
  tb.innerHTML = "";

  if(!data.tasks.length){
    tb.innerHTML = `<tr><td colspan="4" class="p-6 text-center text-slate-400">No tasks today</td></tr>`;
    return;
  }

  data.tasks.forEach(t=>{
    tb.innerHTML += `
    <tr class="border-t border-slate-800">
      <td class="p-3">${t.clientId}</td>
      <td class="p-3">${t.task}</td>
      <td class="p-3 text-yellow-400">${t.status}</td>
      <td class="p-3">
        <button onclick="submit('${t.taskId}')" class="bg-purple-600 px-3 py-1 rounded text-xs">Submit Proof</button>
      </td>
    </tr>`;
  });
}

function submit(taskId){
  const proof = prompt("Paste proof link:");
  if(!proof) return;

  fetch(API,{
    method:"POST",
    body:JSON.stringify({action:"submitTaskProof",taskId,proof})
  }).then(()=>loadTasks());
}

function logout(){
  localStorage.removeItem("email");
  location.href="login.html";
}

loadTasks();
</script>

</body>
</html>
